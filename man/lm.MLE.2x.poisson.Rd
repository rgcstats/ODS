% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lm_MLE_2x_poisson copy.R, R/lm_MLE_2x_poisson.R
\name{lm.MLE.2x.poisson}
\alias{lm.MLE.2x.poisson}
\alias{lm.MLE.2x.poisson}
\title{Calculates maximum likelihood estimators for linear regression of complex survey data}
\usage{
lm.MLE.2x.poisson(ys, x1s, x2s, pi.s, pi.fn, Rquad = 100, start.beta,
  start.sd)

lm.MLE.2x.poisson(ys, x1s, x2s, pi.s, pi.fn, Rquad = 100, start.beta,
  start.sd)
}
\arguments{
\item{ys}{vector of sample values of the dependent variable}

\item{x1s}{sample values for covariate 1 (continuous)}

\item{x2s}{sample values for covariate 2 (binary)}

\item{pi.s}{n-vector (where n=length(y)) of probabilities of selection for the sample units}

\item{pi.fn}{The probability that a unit is selected as a function of y.}

\item{Rquad}{number of quadrature points used in calculating the likelihood}

\item{start.beta}{vector containing (b0,b1,b2) start values}

\item{start.sd}{scalar start value for sd of Y given X}

\item{ys}{vector of sample values of the dependent variable}

\item{x1s}{sample values for covariate 1 (continuous)}

\item{x2s}{sample values for covariate 2 (binary)}

\item{pi.fn}{The probability that a unit is selected as a function of y.}

\item{pi.s}{n-vector (where n=length(y)) of probabilities of selection for the sample units}

\item{Rquad}{number of quadrature points used in calculating the likelihood}

\item{start.beta}{vector containing (b0,b1,b2) start values}

\item{start.sd}{scalar start value for sd of Y given X}
}
\value{
a vector containing p estimated coefficients (where p=ncol(xs)) and the
estimated error standard deviation. No variance estimates provided.

a vector containing p estimated coefficients (where p=ncol(xs)) and the
estimated error standard deviation. No variance estimates provided.
}
\description{
This function fits a linear model to complex sample data by maximum likelihood

This function fits a linear model to complex sample data by maximum likelihood
}
\details{
Add some details later.

Add some details later.
}
\examples{
data(population_example)
eg.ybar.pi <- sum(sample.example$y/sample.example$pi) / sum(1/sample.example$pi)
eg.s2.pi <- sum((sample.example$y-eg.ybar.pi)^2/sample.example$pi)/sum(1/sample.example$pi)
eg.pi.fn <- function(y){ out <- sqrt( 0.1 + 0.9*(y-eg.ybar.pi)^2/eg.s2.pi )
out <- out * mean(sample.example$pi) /
       mean(sqrt( 0.1 + 0.9*(sample.example$y-eg.ybar.pi)^2/eg.s2.pi ))
out  }
lm.MLE.2x.poisson(ys=sample.example$y,x1s=sample.example$x1,x2s=sample.example$x2,pi.fn=eg.pi.fn,
       pi.s=sample.example$pi,R=10)
data(population_example)
eg.ybar.pi <- sum(sample.example$y/sample.example$pi) / sum(1/sample.example$pi)
eg.s2.pi <- sum((sample.example$y-eg.ybar.pi)^2/sample.example$pi)/sum(1/sample.example$pi)
eg.pi.fn <- function(y){ out <- sqrt( 0.1 + 0.9*(y-eg.ybar.pi)^2/eg.s2.pi )
out <- out * mean(sample.example$pi) /
       mean(sqrt( 0.1 + 0.9*(sample.example$y-eg.ybar.pi)^2/eg.s2.pi ))
out  }
lm.MLE.2x.poisson(ys=sample.example$y,x1s=sample.example$x1,x2s=sample.example$x2,pi.fn=eg.pi.fn,
       pi.s=sample.example$pi,R=10)
}
